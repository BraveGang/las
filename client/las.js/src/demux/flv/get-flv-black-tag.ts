/*
 * @Author: gengxing 
 * @Date: 2020-06-09 11:54:56 
 * @Last Modified by:   gengxing 
 * @Last Modified time: 2020-06-09 11:54:56 
 * 获取黑屏tag
 */
import { FlvTag, FlvTagType } from '../../types/flv-object';

const AVCDecoderConfiguration = new Uint8Array([23, 0, 0, 0, 0, 1, 100, 0, 10, 255, 225, 0, 24, 103, 100, 0, 10, 172, 114, 4, 68, 122, 16, 0, 0, 3, 0, 16, 0, 0, 3, 3, 32, 241, 34, 88, 70, 1, 0, 6, 104, 232, 67, 143, 44, 139]);
const AVCKeyFrame = new Uint8Array([23, 1, 0, 0, 0, 0, 0, 2, 176, 6, 5, 255, 255, 172, 220, 69, 233, 189, 230, 217, 72, 183, 150, 44, 216, 32, 217, 35, 238, 239, 120, 50, 54, 52, 32, 45, 32, 99, 111, 114, 101, 32, 49, 53, 50, 32, 114, 50, 56, 53, 52, 32, 101, 57, 97, 53, 57, 48, 51, 32, 45, 32, 72, 46, 50, 54, 52, 47, 77, 80, 69, 71, 45, 52, 32, 65, 86, 67, 32, 99, 111, 100, 101, 99, 32, 45, 32, 67, 111, 112, 121, 108, 101, 102, 116, 32, 50, 48, 48, 51, 45, 50, 48, 49, 55, 32, 45, 32, 104, 116, 116, 112, 58, 47, 47, 119, 119, 119, 46, 118, 105, 100, 101, 111, 108, 97, 110, 46, 111, 114, 103, 47, 120, 50, 54, 52, 46, 104, 116, 109, 108, 32, 45, 32, 111, 112, 116, 105, 111, 110, 115, 58, 32, 99, 97, 98, 97, 99, 61, 49, 32, 114, 101, 102, 61, 49, 54, 32, 100, 101, 98, 108, 111, 99, 107, 61, 49, 58, 48, 58, 48, 32, 97, 110, 97, 108, 121, 115, 101, 61, 48, 120, 51, 58, 48, 120, 49, 51, 51, 32, 109, 101, 61, 117, 109, 104, 32, 115, 117, 98, 109, 101, 61, 49, 48, 32, 112, 115, 121, 61, 49, 32, 112, 115, 121, 95, 114, 100, 61, 49, 46, 48, 48, 58, 48, 46, 48, 48, 32, 109, 105, 120, 101, 100, 95, 114, 101, 102, 61, 49, 32, 109, 101, 95, 114, 97, 110, 103, 101, 61, 50, 52, 32, 99, 104, 114, 111, 109, 97, 95, 109, 101, 61, 49, 32, 116, 114, 101, 108, 108, 105, 115, 61, 50, 32, 56, 120, 56, 100, 99, 116, 61, 49, 32, 99, 113, 109, 61, 48, 32, 100, 101, 97, 100, 122, 111, 110, 101, 61, 50, 49, 44, 49, 49, 32, 102, 97, 115, 116, 95, 112, 115, 107, 105, 112, 61, 49, 32, 99, 104, 114, 111, 109, 97, 95, 113, 112, 95, 111, 102, 102, 115, 101, 116, 61, 45, 50, 32, 116, 104, 114, 101, 97, 100, 115, 61, 49, 32, 108, 111, 111, 107, 97, 104, 101, 97, 100, 95, 116, 104, 114, 101, 97, 100, 115, 61, 49, 32, 115, 108, 105, 99, 101, 100, 95, 116, 104, 114, 101, 97, 100, 115, 61, 48, 32, 110, 114, 61, 48, 32, 100, 101, 99, 105, 109, 97, 116, 101, 61, 49, 32, 105, 110, 116, 101, 114, 108, 97, 99, 101, 100, 61, 48, 32, 98, 108, 117, 114, 97, 121, 95, 99, 111, 109, 112, 97, 116, 61, 48, 32, 99, 111, 110, 115, 116, 114, 97, 105, 110, 101, 100, 95, 105, 110, 116, 114, 97, 61, 48, 32, 98, 102, 114, 97, 109, 101, 115, 61, 56, 32, 98, 95, 112, 121, 114, 97, 109, 105, 100, 61, 50, 32, 98, 95, 97, 100, 97, 112, 116, 61, 50, 32, 98, 95, 98, 105, 97, 115, 61, 48, 32, 100, 105, 114, 101, 99, 116, 61, 51, 32, 119, 101, 105, 103, 104, 116, 98, 61, 49, 32, 111, 112, 101, 110, 95, 103, 111, 112, 61, 48, 32, 119, 101, 105, 103, 104, 116, 112, 61, 50, 32, 107, 101, 121, 105, 110, 116, 61, 50, 53, 48, 32, 107, 101, 121, 105, 110, 116, 95, 109, 105, 110, 61, 50, 53, 32, 115, 99, 101, 110, 101, 99, 117, 116, 61, 52, 48, 32, 105, 110, 116, 114, 97, 95, 114, 101, 102, 114, 101, 115, 104, 61, 48, 32, 114, 99, 95, 108, 111, 111, 107, 97, 104, 101, 97, 100, 61, 54, 48, 32, 114, 99, 61, 99, 114, 102, 32, 109, 98, 116, 114, 101, 101, 61, 49, 32, 99, 114, 102, 61, 50, 51, 46, 48, 32, 113, 99, 111, 109, 112, 61, 48, 46, 54, 48, 32, 113, 112, 109, 105, 110, 61, 48, 32, 113, 112, 109, 97, 120, 61, 54, 57, 32, 113, 112, 115, 116, 101, 112, 61, 52, 32, 105, 112, 95, 114, 97, 116, 105, 111, 61, 49, 46, 52, 48, 32, 97, 113, 61, 49, 58, 49, 46, 48, 48, 0, 128, 0, 0, 0, 29, 101, 136, 129, 0, 5, 127, 254, 246, 115, 124, 10, 107, 109, 176, 149, 46, 5, 118, 246, 150, 55, 45, 60, 239, 89, 160, 124, 49, 129]);

/**
 * 获取视频空帧，flv tag（黑屏）
 * @param timestamp 时间戳
 * @param config 是否是sps/pps信息
 */
export function getFlvBlackTag(timestamp: number, config: boolean = false): FlvTag {
    const tag = new FlvTag();
    tag.tagType = FlvTagType.VIDEO;
    if (config) {
        tag.body = AVCDecoderConfiguration;
    } else {
        tag.body = AVCKeyFrame;
    }
    tag.dataSize = tag.body.byteLength;
    tag.timestamp = Math.round(timestamp);
    tag.frameType = 1;
    tag.codecId = 7;
    return tag;
}
